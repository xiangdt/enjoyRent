<!DOCTYPE html>
<html lang="zh">

	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<title>租车系统后台</title>
		<script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
		<script src="js/bootstrap.min.js" type="text/javascript"></script>
		<style type="text/css">
			#left-nav {
				width: 10%;
				height: 650px;
			}
			
			#headLogo {
				width: 100%;
				height: 56px;
			}
			
			#headLogo img {
				height: 56px;
				width: 100%;
			}
			
			.mynav li {
				padding-bottom: 70px;
			}
			
			.mynav li a {
				display: block;
				color: white;
			}
			
			.right-content {
				width: 100%;
				height: 650px;
				background-color: gainsboro;
			}
			
			.manager {
				float: left;
				margin: 10px;
				width: 88%;
				display: none;
			}
			
			#conditionlist {
				display: block;
			}
			
			td img {
				width: 20px;
			}
			
			#operating {
				width: 100px;
				height: 100px;
				font-size: 16px;
			}
			
			#operating a {
				text-align: center;
				margin: 0;
				padding: 0;
			}
		</style>
	</head>

	<body>
		<div id="main">
			<div id="left-nav" class="bg-dark float-left">
				<div id="headLogo"><img src="img/汽车logo.png" onclick="window.location.href='index.html'"></div>
				<nav class="navbar">
					<ul class="nav nav-pills flex-column nav-justified mynav">
						<li class="nav-item">
							<a href="javascript:void(0)" id="condition" class="nav-link active">实时状态</a>
						</li>
						<li class="nav-item">
							<a href="javascript:void(0)" id="cars" class="nav-link">汽车管理</a>
						</li>
						<li class=" nav-item ">
							<a href="javascript:void(0)" id="users" class="nav-link">用户管理</a>
						</li>
						<li class="nav-item">
							<a href="javascript:void(0)" id="works" class="nav-link">业务统计</a>
						</li>
						<li class=" nav-item ">
							<a href="javascript:void(0)" id="addresses" class="nav-link">停车管理</a>
						</li>
					</ul>
				</nav>
			</div>
			<div class="right-content" id="content">
				<div class="card manager" id="conditionlist">
					<div class="card-header bg-info text-white">
						实时汽车情况
					</div>
					<div class="card-body">
						正在用车:&nbsp;&nbsp;&nbsp;&nbsp;<span id="usingCars">3</span>辆
						<div>
							<table class="table table-striped table-hover">
								<thead>
									<tr>
										<th>编号</th>
										<th>车牌</th>
										<th>用户</th>
										<th>开始时间</th>
										<th>电量状态</th>
									</tr>
								</thead>
								<tbody>
									<tr id="contr1">
										<td>1</td>
										<td>湘ADJS5S</td>
										<td>admin</td>
										<td>2018-08-15 14:27</td>
										<td><img src="img/汽车2绿.png" />电量充足</td>
									</tr>
									<tr id="contr2">
										<td>2</td>
										<td>湘ADJS5S</td>
										<td>admin1</td>
										<td>2018-08-15 14:27</td>
										<td><img src="img/汽车2红.png" />电量不足</td>
									</tr>
									<tr id="contr3">
										<td>3</td>
										<td>湘ADJS5S</td>
										<td>admin2</td>
										<td>2018-08-15 14:27</td>
										<td><img src="img/汽车2黄.png" />电量一般</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
				<div class="card manager" id="carslist">
					<div class="card-header bg-info text-white">
						所有汽车一览
					</div>
					<div class="card-body">
						总数:&nbsp;&nbsp;&nbsp;&nbsp;<span id="usingCars">4</span>辆
						<div>
							<table class="table table-striped table-hover">
								<thead>
									<tr>
										<th>编号</th>
										<th>车牌</th>
										<th>类型</th>
										<th>所在位置</th>
										<th>能源情况</th>
										<th>车辆状况</th>
									</tr>
								</thead>
								<tbody>
									<tr id="cartr1">
										<td>1</td>
										<td>湘ADJS5S</td>
										<td>电能驱动</td>
										<td>1</td>
										<td>
											<div class="progress">
												<div class="progress-bar bg-success" style="width:98%">98%</div>
											</div>
										</td>
										<td><img src="img/汽车2绿.png" />可租赁</td>
									</tr>
									<tr id="cartr2">
										<td>2</td>
										<td>湘ADJS5S</td>
										<td>电能驱动</td>
										<td>1</td>
										<td>
											<div class="progress">
												<div class="progress-bar bg-warning" style="width:45%">45%</div>
											</div>
										</td>
										<td><img src="img/汽车2蓝.png" />正在使用</td>
									</tr>
									<tr id="cartr3">
										<td>3</td>
										<td>湘ADJS5S</td>
										<td>电能驱动</td>
										<td>1</td>
										<td>
											<div class="progress">
												<div class="progress-bar bg-danger" style="width:12%">12%</div>
											</div>
										</td>
										<td><img src="img/汽车2红.png" />不可租用,待充电</td>
									</tr>
									<tr id="cartr4">
										<td>4</td>
										<td>湘ADJS5S</td>
										<td>电能驱动</td>
										<td>1</td>
										<td>
											<div class="progress">
												<div class="progress-bar bg-success" style="width:56%">56%</div>
											</div>
										</td>
										<td><img src="img/汽车2黄.png" />不可租用,待维修</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
				<div class="card manager" id="userslist">
					<div class="card-header bg-info text-white">
						所有用户一览
					</div>
					总数:&nbsp;&nbsp;&nbsp;&nbsp;<span id="user1"></span>人
					<button type="button" name="" onclick="del(${user.userid})" id="add" class="btn btn-dark ">添加</button>
					<div class="card-body">
						<div>
							<table class="table table-striped table-hover">
								<thead>
									<tr>
										<th>编号</th>
										<th>姓名</th>
										<th>性别</th>
										<th>电话</th>
										<th>邮箱</th>
										<th>地址</th>
										<th>用户状态</th>
										<th>加入时间</th>
									</tr>
								</thead>
								<tbody id="mytbody">
								</tbody>
							</table>
						</div>
					</div>
				</div>
				<div class="card manager" id="worklist">
					<div class="card-header bg-info text-white">
						业务一览
					</div>
					<div class="card-body">
						总数:&nbsp;&nbsp;&nbsp;&nbsp;<span id="usingCars">34</span>条
						<div id="carsTable">
							<table class="table table-striped table-hover">
								<thead>
									<tr>
										<th>编号</th>
										<th>类型</th>
										<th>用户</th>
										<th>车辆车牌</th>
										<th>时间</th>
									</tr>
								</thead>
								<tbody>
									<tr id="wortr1">
										<td>1</td>
										<td>租赁</td>
										<td>姜大成</td>
										<td>湘A456SD</td>
										<td>2018-08-15 17:50</td>
									</tr>
									<tr id="wortr2">
										<td>2</td>
										<td>归还</td>
										<td>姜大成</td>
										<td>湘A456SD</td>
										<td>2018-08-15 17:50</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
				<div class="card manager" id="addresslist">
					<div class="card-header bg-info text-white">
						停车情况一览
					</div>
					<div class="card-body">
						总数:&nbsp;&nbsp;&nbsp;&nbsp;<span id="pnum"></span>个地点
						<button type="button" name="" onclick="up(${p.parkid})" id="addP" class="btn btn-dark ">添加</button>

						<div id="carsTable">
							<table class="table table-striped table-hover">
								<thead>
									<tr>
										<th>编号</th>
										<th>最大停车数量</th>
										<th>地址</th>
										<th>停车场状态</th>
									</tr>
								</thead>
								<tbody id="parkList">

								</tbody>
							</table>
						</div>
					</div>

				</div>
			</div>
			<!-- 按钮：用于打开模态框 -->
			<input type="hidden" id="openModal" class="btn btn-primary" data-toggle="modal" data-target="#trinfo"></button>
			<!-- 模态框 -->
			<div class="modal fade" id="trinfo">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h4 class="modal-title">信息修改</h4>
							<button type="button" class="close" data-dismiss="modal">&times;</button>
						</div>
						<div class="modal-body">
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-primary" id="save">保存</button>
							<button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>
	<script type="text/javascript" src="js/manager.js"></script>
	<script src="layer/layer.js"></script>
<script>
	$(function () {
    $.ajax({
        url:"user",
        dataType:"json",
        data:{action:""},
        success:function (data) {
            data.forEach(user=>{
                let $tr=$(`
                      <tr id="user${user.userid}">
                          <td>${user.userid}</td>
                          <td>${user.name}</td>
                          <td>${user.sex}</td>
                          <td>${user.mobile}</td>
                          <td>${user.email}</td>
                          <td>${user.address}</td>
                          <td>${user.userstate}</td>
                          <td>${user.jointime}</td>
                          <td>
                            <button type="button" name="" onclick="updata (${user.userid})" id="${user.userid}" class="btn btn-dark btn-block">修改</
                            <button>
                          </td>
                    </tr>`)
                console.log(user)
                $("#mytbody").append($tr)
            })
            console.log(data.length)
            $("#user1").text(data.length)
        }
    })
	$.ajax({
		url:"parks",
		dataType:"json",
		data:{action:"findAll"},
		success:function (data) {
			data.forEach(p=>{
			    let $tr=$(`
			    		<tr>
			    		<td>${p.parkid}</td>
			    		<td>${p.sum}</td>
			    		<td>${p.site}</td>
			    		<td>${p.parktype}</td>
			    		<td>
                            <button type="button" name="" onclick="updataP (${p.parkid})" id="${p.parkid}" class="btn btn-dark btn-block">修改</
                            <button>
                          </td>
				</tr>`)
                console.log(p)
				$("#parkList").append($tr)
			})
            console.log(data.length)
            $("#pnum").text(data.length)
        }
	})
    })
    $('#addP').on('click', function(){
        layer.open({
            type: 1,
            area: ['600px', '360px'],
            shadeClose: true, //点击遮罩关闭
            content: '\<\div style="padding:20px;">' +
				'<from id="formadd>' +
				'<div class="card-header">添加停车场</div>' +
                '<div class="card-body">' +
                '<form>' +
                '<div class="form-group">' +
                '<label for="username">最大停车数量:</label>' +
                '<input type="text" class="form-control" id="username" name="username">' +
                '</div>' +
                '<div class="form-group">' +
                '<label for="text">地址:</label>' +
                '<input type="text" class="form-control" id="password" name="password">' +
                '</div>' +
                '<button type="button" class="btn btn-primary" id="loginUp">添加</button>' +
                '</form>' +
                '</div>' +
				'</from>\<\/div>'
        });
        $("#loginUp").click(function () {
            $.ajax({
                url:"parks",
                data:{action:"addP"},
				type:"post",
                success:function (data) {
                    if(data==="1"){
                        alert("添加成功")
                    }
                }
            })
        })
    });


	function updataP(id) {

            layer.open({
                type: 1,
                area: ['600px', '360px'],
                shadeClose: true, //点击遮罩关闭
                content: '\<\div style="padding:20px;">自定义内容\<\/div>'
            });

    }

</script>

</html>